<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="/assets/css/user/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/admin/dashboard.css">
    <link rel="stylesheet" href="/assets/css/admin/newDashboard.css">
    <link rel="stylesheet" href="/assets/css/admin/salesReport.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.0/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.16.0/dist/pdf-lib.min.js"></script>
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gentelella/1.3.0/css/custom.css"> -->



    <title>Document</title>
</head>

<body>
    <div class="container-fluid mainConatainer" style="display: flex;">

        <div class="col-0 left-Menu-Bar-active" style="display: none;">
            <div class="row" style="display: flex;flex-direction: column;justify-content: center;align-items: center;">
                <img class="adminPanel" src="/assets/images/admin-panel2.png" style="margin-left: 0;" alt="">
                <br><br>
                <a class="active-Icons " onclick="btnClick(this)" href="adminDashboard"><i
                        class="fa fa-home menuBtn" style="font-size: 30px;"></i></a>
                <a class="active-Icons" onclick="btnClick(this)" href="ProductList"><img
                        src="/assets/images/productIcon.png" alt=""></a>
                <a class="active-Icons" onclick="btnClick(this)" href="Category"><img src="/assets/images/category.png"
                        alt=""></a>
                <a class="active-Icons" onclick="btnClick(this)" href="orderHistory"><img
                        src="/assets/images/orderHistory.png" alt=""></a>
                <a class="active-Icons" onclick="btnClick(this)" href="coupon"><img src="/assets/images/couponIcon.png"
                        alt=""></a>
                <a class="active-Icons active" onclick="btnClick(this)" href="salesReport"><img src="/assets/images/sales.png"
                        style="width: 30px;height: 30px;" alt=""></a>
                <a class="active-Icons" onclick="btnClick(this)" href="CustomerDetails"><img
                        src="/assets/images/userRport.png" alt=""></a>
                <a class="active-Icons" onclick="btnClick(this)" href="offers"><img src="/assets/images/coupon.png"
                        style="width: 30px;height: 30px;" alt=""></a>
            </div>
        </div>

        <div class="left-Menu-Bar">
            <div class="row">
                <img class="adminPanel" src="/assets/images/admin-panel2.png" alt="">
                <span>Admin</span>
            </div>
            <div class="row">
                <br><br>
                <div class="menu_section">

                    <ul class="nav side-menu">
                        <li class="side-menu-li " onclick="menuBtn(this)">
                            <a href="adminDashboard" class="side-menu-a-tag">
                                <i class="fa fa-home menuBtn"><span>DashBoard</span></i>
                                <span class="fa fa-chevron-right"></span>
                            </a>
                        </li>
                        <li class="side-menu-li" onclick="menuBtn(this)">
                            <a href="ProductList" class="side-menu-a-tag">
                                <i class="menuBtn"><img src="/assets/images/productIcon.png"
                                        style="width: 19px;height: 19px;" alt="">
                                    <span
                                        style="font-family: Helvetica Neue, Roboto, Arial, Droid Sans, sans-serif;padding-left: 5px;">Products</span></i>
                                <span class="fa fa-chevron-right"></span>
                            </a>
                        </li>
                        <li class="side-menu-li" onclick="menuBtn(this)">
                            <a href="Category" class="side-menu-a-tag">
                                <i class="menuBtn"><img src="/assets/images/category.png"
                                        style="width: 19px;height: 23px;" alt="">
                                    <span
                                        style="font-family: Helvetica Neue, Roboto, Arial, Droid Sans, sans-serif;padding-left: 5px;">Category</span></i>
                                <span class="fa fa-chevron-right"></span>

                            </a>
                        </li>
                        <li class="side-menu-li" onclick="menuBtn(this)">
                            <a href="orderHistory" class="side-menu-a-tag">
                                <i class="menuBtn"><img src="/assets/images/orderHistory.png"
                                        style="width: 19px;height: 19px;" alt="">
                                    <span
                                        style="font-family: Helvetica Neue, Roboto, Arial, Droid Sans, sans-serif;padding-left: 5px;">Order
                                        History</span></i>
                                <span class="fa fa-chevron-right"></span>
                            </a>
                        </li>
                        <li class="side-menu-li" onclick="menuBtn(this)">
                            <a href="coupon" class="side-menu-a-tag">
                                <i class="menuBtn"><img src="/assets/images/couponIcon.png"
                                        style="width: 22px;height: 22px;" alt="">
                                    <span
                                        style="font-family: Helvetica Neue, Roboto, Arial, Droid Sans, sans-serif;padding-left: 5px;">Coupon</span></i>
                                <span class="fa fa-chevron-right"></span>
                            </a>
                        </li>
                        <li class="side-menu-li active" onclick="menuBtn(this)">
                            <a href="salesReport" class="side-menu-a-tag">
                                <i class="menuBtn"><img src="/assets/images/sales.png" style="width: 22px;height: 22px;"
                                        alt="">
                                    <span
                                        style="font-family: Helvetica Neue, Roboto, Arial, Droid Sans, sans-serif;padding-left: 5px;">Sales
                                        Report</span></i>
                                <span class="fa fa-chevron-right"></span>
                            </a>
                        </li>
                        <li class="side-menu-li" onclick="menuBtn(this)">
                            <a href="CustomerDetails" class="side-menu-a-tag">
                                <i class="menuBtn"><img src="/assets/images/userRport.png"
                                        style="width: 19px;height: 19px;" alt="">
                                    <span
                                        style="font-family: Helvetica Neue, Roboto, Arial, Droid Sans, sans-serif;padding-left: 5px;">User
                                        Report</span></i>
                                <span class="fa fa-chevron-right"></span>
                            </a>
                        </li>
                        <li class="side-menu-li" onclick="menuBtn(this)">
                            <a href="offers" class="side-menu-a-tag">
                                <i class="menuBtn"><img src="/assets/images/coupon.png"
                                        style="width: 22px;height: 22px;" alt="">
                                    <span
                                        style="font-family: Helvetica Neue, Roboto, Arial, Droid Sans, sans-serif;padding-left: 5px;">Offers</span></i>
                                <span class="fa fa-chevron-right"></span>
                            </a>
                        </li>
                    </ul>
                </div>

            </div>
        </div>
        <div class="right-Menu-Bar">
            <div class="row NavbarRow">
                <div class="menuIcon"><a id="MenuBtn"><i class="fa fa-bars"></i></a></div>
                <div class="other-Settings">
                    <a class="msgIcon" href="messageBox"><i class="fa fa-envelope-o"></i> <span
                            class="badge bg-green">6</span></a>
                    <a href="" class="profileName">
                        <b>hexashop@gmail.com</b><span class="fa fa-chevron-down"></span>
                    </a>
                </div>
            </div>
            <!-- <div class="row log-DropDown">
                                        <div class="logoutTab">

                                        </div>
                                </div> -->
            <div class="row" >
                <div class="col-12 row2">
                    <div class="col-2 pageHead">
                        <h3>Sales Report</h3>
                    </div>
                    <div class="col-6 col2">
                        <div class="col-12 col3">

                            <input type="text" class="searchInput" name="search" required="true"
                                id="exampleFormControlInput1" placeholder="Search ">
                            <span><a href=""><i class="fa-solid fa-magnifying-glass searchBtn"
                                        style="color: #8b8e99;"></i></a></span>
                            </form>
                        </div>
                    </div>
                    <div class="col-3 col2">
                        <a><button onclick="generatePDF('<%= JSON.stringify(salesReport) %>')"
                                class=" btn btnPDF" id="addCoupon"><span><i class="fa-solid fa-download"
                                        style="color: #ffffff;"></i></span>PDF</button></a>
                        <a><button onclick="generateExcel('<%= JSON.stringify(salesReport) %>')"
                                class=" btn btnExcel" id="addCoupon"><span><i class="fa-solid fa-download"
                                        style="color: #ffffff;"></i></span>Exel</button></a>
                    </div>
                </div>
            </div>

            <br>

            <div class="row row3">
                <div class="col-7 col7">
                    <div class=" sort-UsageRow">
                        <a href="salesReport?filter=All"  id="all">All</a>
                        <span><a href="salesReport?filter=Daily" id="Daily">Daily</a></span>
                        <span><a href="salesReport?filter=Monthly" id="Monthly">Monthly</a></span>
                        <span><a href="salesReport?filter=Yearly" id="Yearly">Yearly</a></span>

                    </div>
                </div>
                <div class="col-5 sort-AddedRow" style="padding-right: 7px;">
                    <div class="dateBox">
                     <a href=""><input type="date" onchange="customDateFilter()" class="dateInput" id="startDate"></a>
                    </div>
                    <div class="dateBox2">
                        <a href=""> <input type="date" onchange="customDateFilter()" class="dateInput" id="endDate"></a>
                    </div>
                </div>
            </div>


            <div class="row" id="salesheading" style="border-top: 1px solid rgb(112, 112, 112);border-bottom: 1px solid rgb(112, 112, 112);height: 50px;">

                <div class="headingDiv" style="width: 6%;">SI</div>
                <div class="headingDiv">Customer Details</div>
                <div class="headingDiv">Products</div>
                <div class="headingDiv">Address</div>
                <div class="headingDiv">Order Date</div>
                <div class="headingDiv">Payment Mode</div>
                <div class="headingDiv">Amount</div>
            </div>

            <% salesReport.forEach((val,index)=> { %>
                <div class="row salesDetails" id="" style="border-top: 1px solid rgb(112, 112, 112);border-bottom: 1px solid rgb(112, 112, 112);">
                    <div class="contentDiv" style="width: 6%;font-weight: bold;">
                        <%= index+1 %>
                    </div>
                    <div class="contentDiv">
                        <%=val.addressID.fullName%>,<br>
                            <%=val.addressID.emailAddress%>
                    </div>
                    <div class="contentDiv">
                        <%=val.productID.ProductName%>
                    </div>
                    <div class="contentDiv">
                        <%=val.addressID.address%>, <%=val.addressID.cityDistrictTown%>,
                                <%=val.addressID.state%>,<%=val.addressID.pincode%>,
                    </div>
                    <div class="contentDiv">
                        <%=val.OrderDate.toLocaleDateString()%>
                    </div>
                    <div class="contentDiv" style="display: flex;flex-direction: column;">
                        <% if(val.PaymentMethod==='Online Payment' ) { %>
                            RAZORPAY <br>
                            <% if(val.couponDiscount > 0) { %> 
                                <b style="color: green;">Saved <%= (val.productID.SalesRate * val.Quantity) * val.couponDiscount / 100 + (val.productID.MRP * val.Quantity - val.productID.SalesRate * val.Quantity)  %></b>
                            <% } else{ %>
                                <b style="color: green;">Saved  <%=(val.productID.MRP * val.Quantity - val.productID.SalesRate * val.Quantity)%> </b>
                            <% } %>
                        <% } else { %>
                                <%=val.PaymentMethod%>
                                <% if(val.couponDiscount > 0) { %> 
                                    <b style="color: green;">Saved <%= (val.productID.SalesRate * val.Quantity) * val.couponDiscount / 100 + (val.productID.MRP * val.Quantity - val.productID.SalesRate * val.Quantity)  %></b>
                                <% } else{ %>
                                    <b style="color: green;">Saved  <%=(val.productID.MRP * val.Quantity - val.productID.SalesRate * val.Quantity)%> </b>
                                <% } %>
                        <% } %>

                    </div>
                    <div class="contentDiv">
                        <%=val.Amount%>
                    </div>
                </div>
                <% }) %>



        </div>

    </div>



    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="/assets/js/salesReport.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="/assets/js/dashboard.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</body>

</html>